(()=>{var a="mastodon-instance",o=localStorage.getItem(a);o=o===null?"":o;var t=document.querySelector(".mastodon-share"),d=n=>{let e=u(n);console.log(e),e?e=n:e="https://"+n,t.href=`${e}/share?text=${encodeURIComponent(document.title)}%0A${encodeURIComponent(location.href)}`};function u(n){try{return new URL(n),!0}catch(e){return!1}}if(t){let n=t.dataset.prompt||"Add your Mastodon instance, e.g. wptoots.social",e=t.dataset.editlabel||"Edit your Mastodon instance",s=t.dataset.edittext||"\u270F\uFE0F",c=r=>{o=window.prompt(n,o),o&&(localStorage.setItem(a,o),i(),d(o),t.click())},i=r=>{if(document.querySelector("button.mastodon-edit"))return;let l=document.createElement("button");l.innerText=s,l.classList.add("mastodon-edit"),l.title=e,l.ariaLabel=e,l.addEventListener("click",m=>{m.preventDefault(),localStorage.removeItem(a),c()}),t.insertAdjacentElement("afterend",l)};localStorage.getItem(a)&&i(),t.addEventListener("click",r=>{localStorage.getItem(a)?d(localStorage.getItem(a)):(r.preventDefault(),c())})}})();
